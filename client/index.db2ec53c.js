import{S as e,i as t,s as n,e as i,c as l,a as s,d as a,b as o,f as r,g as c,l as u,n as f,h,j as p,k as d,m,o as g,p as b,t as y,r as w,u as x,v as $,w as v,x as k,y as E,z as I,A as D,B as V,C as T,D as j,E as z,F as O}from"./client.47ea9a2a.js";import{g as A,a as B,b as W,f as C,c as F,E as N}from"./index.9e6369a0.js";function R(e){let t,n,h,p,d,m,g;return{c(){t=i("a"),n=i("figure"),h=i("video"),this.h()},l(e){t=l(e,"A",{rel:!0,href:!0,class:!0});var i=s(t);n=l(i,"FIGURE",{});var o=s(n);h=l(o,"VIDEO",{class:!0,muted:!0,autoplay:!0,playsinline:!0,"webkit-playsinline":!0,poster:!0}),s(h).forEach(a),o.forEach(a),i.forEach(a),this.h()},h(){o(h,"class","w-full bg-white"),h.muted=!0,h.autoplay=!0,h.playsInline=!0,o(h,"webkit-playsinline",""),o(h,"poster",p=A(e[0])),o(t,"rel","prefetch"),o(t,"href",d="/exhibits/"+e[0].key),o(t,"class","m-px exhibit relative w-84")},m(i,l){r(i,t,l),c(t,n),c(n,h),e[3](h),m||(g=u(h,"mouseover",e[2]),m=!0)},p(e,[n]){1&n&&p!==(p=A(e[0]))&&o(h,"poster",p),1&n&&d!==(d="/exhibits/"+e[0].key)&&o(t,"href",d)},i:f,o:f,d(n){n&&a(t),e[3](null),m=!1,g()}}}function G(e,t,n){let i,{exhibit:l}=t,s=!1;return e.$$set=e=>{"exhibit"in e&&n(0,l=e.exhibit)},[l,i,function(){s||(s=!0,n(1,i.src=B(l),i),n(1,i.oncanplay=()=>{n(1,i.poster=W(l),i),i.play()},i))},function(e){h[e?"unshift":"push"]((()=>{i=e,n(1,i)}))}]}class H extends e{constructor(e){super(),t(this,e,G,R,n,{exhibit:0})}}function P(e){let t,n,c,u;return{c(){t=i("video"),this.h()},l(e){t=l(e,"VIDEO",{class:!0,muted:!0,playsinline:!0,"webkit-playsinline":!0,poster:!0}),s(t).forEach(a),this.h()},h(){o(t,"class","absolute inset-0 w-full h-full z-10"),t.muted=!0,t.playsInline=!0,o(t,"webkit-playsinline",""),o(t,"poster",n=A(e[0]))},m(n,i){r(n,t,i),e[13](t),u=!0},p(e,i){(!u||1&i&&n!==(n=A(e[0])))&&o(t,"poster",n)},i(e){u||(c&&c.end(1),u=!0)},o(e){e&&(c=d(t,C,{})),u=!1},d(n){n&&a(t),e[13](null),n&&c&&c.end()}}}function S(e){let t,n,f,h,d,I,D,V,T,j,z,O=!1,B=()=>{O=!1};p(e[11]),p(e[12]);let W=e[7]&&P(e);return{c(){n=i("div"),f=i("a"),h=i("div"),d=m(),I=i("div"),D=m(),W&&W.c(),this.h()},l(e){n=l(e,"DIV",{class:!0,style:!0});var t=s(n);f=l(t,"A",{rel:!0,href:!0,class:!0});var i=s(f);h=l(i,"DIV",{class:!0,style:!0}),s(h).forEach(a),d=g(i),I=l(i,"DIV",{class:!0,style:!0}),s(I).forEach(a),D=g(i),W&&W.l(i),i.forEach(a),t.forEach(a),this.h()},h(){o(h,"class","absolute inset-0 bg-cover"),b(h,"background-image","url("+A(e[0])+")"),y(h,"opacity-0",e[8]),o(I,"class","absolute inset-0 bg-cover transition-opacity duration-500"),b(I,"background-image","url("+F(e[0])+")"),y(I,"opacity-0",!e[8]),o(f,"rel","prefetch"),o(f,"href",V="/exhibits/"+e[0].key),o(f,"class","m-px w-full bg-blue-500"),o(n,"class","relative w-full m-1 mx-2 h-96"),b(n,"height",e[9]+"px"),p((()=>e[14].call(n)))},m(i,l){r(i,n,l),c(n,f),c(f,h),c(f,d),c(f,I),c(f,D),W&&W.m(f,null),T=w(n,e[14].bind(n)),e[15](n),j||(z=[u(window,"scroll",e[10]),u(window,"scroll",(()=>{O=!0,clearTimeout(t),t=setTimeout(B,100),e[11]()})),u(window,"resize",e[12])],j=!0)},p(e,[i]){24&i&&!O&&(O=!0,clearTimeout(t),scrollTo(e[3],e[4]),t=setTimeout(B,100)),1&i&&b(h,"background-image","url("+A(e[0])+")"),256&i&&y(h,"opacity-0",e[8]),1&i&&b(I,"background-image","url("+F(e[0])+")"),256&i&&y(I,"opacity-0",!e[8]),e[7]?W?(W.p(e,i),128&i&&x(W,1)):(W=P(e),W.c(),x(W,1),W.m(f,null)):W&&($(),v(W,1,1,(()=>{W=null})),k()),1&i&&V!==(V="/exhibits/"+e[0].key)&&o(f,"href",V),512&i&&b(n,"height",e[9]+"px")},i(e){x(W)},o(e){v(W)},d(t){t&&a(n),W&&W.d(),T(),e[15](null),j=!1,E(z)}}}function U(...e){console.log("[autoplay]",...e)}function X(e,t,n){let i,l,s,a,o,r,c,{exhibit:u}=t,f=!0,p=!1,d=!1;function m(e){const t=l.getBoundingClientRect(),s=t.top>=0&&t.bottom<=e,a=t.bottom<=0||t.top>=e;s&&!p&&(console.log("Playing video "+u.key,t),d||(d=!0,n(7,f=!0),n(1,i.src=B(u),i),i.play(),U("init video element"),n(1,i.oncanplay=()=>{U("canplay fired"),i.play()},i),n(1,i.onerror=()=>{U("onerror fired")},i),n(1,i.onended=()=>{U("onended fired"),f&&(n(7,f=!1),n(8,p=!0))},i))),a&&d&&i&&(i.pause(),n(1,i.src=null,i),i.load(),d=!1)}return I((()=>{m(r)})),e.$$set=e=>{"exhibit"in e&&n(0,u=e.exhibit)},[u,i,l,s,a,o,r,f,p,c,function(){m(r)},function(){n(3,s=window.pageXOffset),n(4,a=window.pageYOffset)},function(){n(5,o=window.innerWidth),n(6,r=window.innerHeight)},function(e){h[e?"unshift":"push"]((()=>{i=e,n(1,i)}))},function(){c=this.clientWidth,n(9,c)},function(e){h[e?"unshift":"push"]((()=>{l=e,n(2,l)}))}]}class Y extends e{constructor(e){super(),t(this,e,X,S,n,{exhibit:0})}}function q(e,t,n){const i=e.slice();return i[3]=t[n],i}function J(e){let t,n,i=N,l=[];for(let t=0;t<i.length;t+=1)l[t]=M(q(e,i,t));const s=e=>v(l[e],1,1,(()=>{l[e]=null}));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=D()},l(e){for(let t=0;t<l.length;t+=1)l[t].l(e);t=D()},m(e,i){for(let t=0;t<l.length;t+=1)l[t].m(e,i);r(e,t,i),n=!0},p(e,n){if(2&n){let a;for(i=N,a=0;a<i.length;a+=1){const s=q(e,i,a);l[a]?(l[a].p(s,n),x(l[a],1)):(l[a]=M(s),l[a].c(),x(l[a],1),l[a].m(t.parentNode,t))}for($(),a=i.length;a<l.length;a+=1)s(a);k()}},i(e){if(!n){for(let e=0;e<i.length;e+=1)x(l[e]);n=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)v(l[e]);n=!1},d(e){V(l,e),e&&a(t)}}}function K(e){let t,n;return t=new H({props:{exhibit:e[3]}}),{c(){T(t.$$.fragment)},l(e){j(t.$$.fragment,e)},m(e,i){z(t,e,i),n=!0},p:f,i(e){n||(x(t.$$.fragment,e),n=!0)},o(e){v(t.$$.fragment,e),n=!1},d(e){O(t,e)}}}function L(e){let t,n;return t=new Y({props:{exhibit:e[3]}}),{c(){T(t.$$.fragment)},l(e){j(t.$$.fragment,e)},m(e,i){z(t,e,i),n=!0},p:f,i(e){n||(x(t.$$.fragment,e),n=!0)},o(e){v(t.$$.fragment,e),n=!1},d(e){O(t,e)}}}function M(e){let t,n,i,l;const s=[L,K],o=[];function c(e,t){return e[1]?0:1}return t=c(e),n=o[t]=s[t](e),{c(){n.c(),i=D()},l(e){n.l(e),i=D()},m(e,n){o[t].m(e,n),r(e,i,n),l=!0},p(e,l){let a=t;t=c(e),t===a?o[t].p(e,l):($(),v(o[a],1,1,(()=>{o[a]=null})),k(),n=o[t],n||(n=o[t]=s[t](e),n.c()),x(n,1),n.m(i.parentNode,i))},i(e){l||(x(n),l=!0)},o(e){v(n),l=!1},d(e){o[t].d(e),e&&a(i)}}}function Q(e){let t,n,c,f;p(e[2]);let h=!!e[0]&&J(e);return{c(){t=i("div"),h&&h.c(),this.h()},l(e){t=l(e,"DIV",{class:!0});var n=s(t);h&&h.l(n),n.forEach(a),this.h()},h(){o(t,"class","flex text-white justify-center flex-wrap")},m(i,l){r(i,t,l),h&&h.m(t,null),n=!0,c||(f=u(window,"resize",e[2]),c=!0)},p(e,[n]){e[0]?h?(h.p(e,n),1&n&&x(h,1)):(h=J(e),h.c(),x(h,1),h.m(t,null)):h&&($(),v(h,1,1,(()=>{h=null})),k())},i(e){n||(x(h),n=!0)},o(e){v(h),n=!1},d(e){e&&a(t),h&&h.d(),c=!1,f()}}}function Z(e,t,n){let i,l;return e.$$.update=()=>{1&e.$$.dirty&&n(1,l=i<768)},[i,l,function(){n(0,i=window.innerWidth)}]}export default class extends e{constructor(e){super(),t(this,e,Z,Q,n,{})}}
